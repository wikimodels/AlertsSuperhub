@if (isLoading()) {
<div class="loading-overlay">
  <app-loading-spinner></app-loading-spinner>
</div>
} @else {

<div class="layout-container">

  <div class="coins-header">
    <app-search-filter (searchChange)="onFilterChange($event)"></app-search-filter>

    <h2 class="header-title">
      Working Line Alerts
      @if (alertsCount() > 0) {
      <span>({{ alertsCount() }})</span>
      }
    </h2>

    <div class="header-actions">
      <app-panel-button [iconPath]="'refresh'" (actionClick)="refresh()" [tooltipText]="'Refresh'"></app-panel-button>
      <app-panel-button [iconPath]="'delete_sweep'" (actionClick)="deleteAll()" [tooltipText]="'Delete All'"
        [disabled]="alertsCount() === 0"></app-panel-button>
      <app-panel-button [iconPath]="'close'" (actionClick)="closeWindows()" [tooltipText]="'Close'"></app-panel-button>
    </div>
  </div>

  <div class="table-wrapper">

    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z0 alerts-table">

      <ng-container matColumnDef="symbol">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-symbol"> SYMBOL </th>
        <td mat-cell *matCellDef="let alert" class="col-symbol">
          <span class="symbol-text">{{ alert.symbol }}</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="price">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-target"> TARGET </th>
        <td mat-cell *matCellDef="let alert" class="col-target"> {{ alert.price }} </td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-type"> TYPE </th>
        <td mat-cell *matCellDef="let alert" class="col-type">
          <span class="type-badge">Line Cross</span>
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <th mat-header-cell *matHeaderCellDef class="col-note"> NOTE </th>
        <td mat-cell *matCellDef="let alert" class="col-note">
          {{ alert.description || 'Alert triggered at ' + alert.price }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="col-actions"></th>
        <td mat-cell *matCellDef="let alert" class="col-actions">
          <button class="delete-icon-btn" (click)="deleteAlert(alert._id!)">
            <mat-icon>close</mat-icon>
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell empty-cell" colspan="5">No data matching the filter</td>
      </tr>
    </table>
  </div>

  <div class="pagination-footer">
    <mat-paginator [pageSizeOptions]="[10, 20, 50, 100]" [pageSize]="10" showFirstLastButtons
      aria-label="Select page of alerts">
    </mat-paginator>
  </div>

</div>
}
